<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="QuerySql.aspx.cs" Inherits="Portal.Modules.OrientalSails.Web.Admin.QuerySql" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <%  Module.CommonDao.OpenSession().CreateSQLQuery("BEGIN TRANSACTION\nSET QUOTED_IDENTIFIER ON\nSET ARITHABORT ON\nSET NUMERIC_ROUNDABORT OFF\nSET CONCAT_NULL_YIELDS_NULL ON\nSET ANSI_NULLS ON\nSET ANSI_PADDING ON\nSET ANSI_WARNINGS ON\nCOMMIT\nBEGIN TRANSACTION\n\nALTER TABLE dbo.os_Booking\n\u0009DROP CONSTRAINT DF_os_Booking_DiscountAmount\n\nALTER TABLE dbo.os_Booking\n\u0009DROP CONSTRAINT DF_os_Booking_DiscountCurrencyType\n\nCREATE TABLE dbo.Tmp_os_Booking\n\u0009(\n\u0009Id int NOT NULL IDENTITY (1, 1),\n\u0009Deleted bit NULL,\n\u0009CreatedBy int NULL,\n\u0009CreatedDate datetime NULL,\n\u0009ModifiedBy int NULL,\n\u0009ModifiedDate datetime NULL,\n\u0009ConfirmedBy int NULL,\n\u0009PartnerId int NULL,\n\u0009SaleId int NULL,\n\u0009StartDate datetime NULL,\n\u0009EndDate datetime NULL,\n\u0009Status int NULL,\n\u0009TripId int NULL,\n\u0009TripOption int NULL,\n\u0009Total money NULL,\n\u0009Paid money NULL,\n\u0009Email nvarchar(200) NULL,\n\u0009Name nvarchar(300) NULL,\n\u0009Note ntext NULL,\n\u0009AgencyId int NULL,\n\u0009PickupAddress nvarchar(500) NULL,\n\u0009SpecialRequest nvarchar(500) NULL,\n\u0009AgencyCode nvarchar(50) NULL,\n\u0009IsApproved bit NULL,\n\u0009CurrencyRate money NULL,\n\u0009IsPaid bit NULL,\n\u0009PaidBase money NULL,\n\u0009IsPaymentNeeded bit NULL,\n\u0009BookerId int NULL,\n\u0009CustomBookingId int NULL,\n\u0009AccountingStatus int NULL,\n\u0009LockedId int NULL,\n\u0009CruiseId int NULL,\n\u0009TransferTo int NULL,\n\u0009TransferAdult int NULL,\n\u0009TransferChildren int NULL,\n\u0009TransferBaby int NULL,\n\u0009Amended int NULL,\n\u0009TransferCost money NULL,\n\u0009IsTransferred bit NULL,\n\u0009IsCharter bit NULL,\n\u0009DropoffAddress nvarchar(MAX) NULL,\n\u0009Invoice bit NULL,\n\u0009CancelPay money NULL,\n\u0009CancelPayVND money NULL,\n\u0009Guide nvarchar(500) NULL,\n\u0009Driver nvarchar(500) NULL,\n\u0009GuideOnboard bit NULL,\n\u0009Locker int NULL,\n\u0009Commission money NULL,\n\u0009CommissionVND money NULL,\n\u0009ComPaid bit NULL,\n\u0009ComUSDPayed money NULL,\n\u0009ComVNDPayed money NULL,\n\u0009ComRate money NULL,\n\u0009GroupNo int NULL,\n\u0009DriverCollect money NULL,\n\u0009GuideCollect money NULL,\n\u0009DriverCollectVND money NULL,\n\u0009GuideCollectVND money NULL,\n\u0009DriverCollected bit NULL,\n\u0009GuideCollected bit NULL,\n\u0009PaidDate datetime NULL,\n\u0009ComPaidDate datetime NULL,\n\u0009TotalVND money NULL,\n\u0009IsVND bit NULL,\n\u0009DriverCollectedUSD money NULL,\n\u0009GuideCollectedUSD money NULL,\n\u0009DriverCollectedVND money NULL,\n\u0009GuideCollectedVND money NULL,\n\u0009GuideConfirmed bit NULL,\n\u0009AgencyConfirmed bit NULL,\n\u0009IsDriverCollectVND bit NULL,\n\u0009IsGuideCollectVND bit NULL,\n\u0009IsCommissionVND bit NULL,\n\u0009IsCancelPayVND bit NULL,\n\u0009LockBy int NULL,\n\u0009LockDate datetime NULL,\n\u0009SeeoffTime datetime NULL,\n\u0009PickupTime datetime NULL,\n\u0009PUFlightDetails nvarchar(MAX) NULL,\n\u0009PUCarRequirements nvarchar(MAX) NULL,\n\u0009SOFlightDetails nvarchar(MAX) NULL,\n\u0009SOCarRequirements nvarchar(MAX) NULL,\n\u0009PUPickupAddress nvarchar(MAX) NULL,\n\u0009PUDropoffAddress nvarchar(MAX) NULL,\n\u0009SOPickupAddress nvarchar(MAX) NULL,\n\u0009SODropoffAddress nvarchar(MAX) NULL,\n\u0009LockStatus nvarchar(MAX) NULL,\n\u0009DiscountAmount money NOT NULL,\n\u0009DiscountPercent float(53) NULL,\n\u0009DiscountCurrencyType nvarchar(10) NOT NULL\n\u0009)  ON [PRIMARY]\n\u0009 TEXTIMAGE_ON [PRIMARY]\n\nALTER TABLE dbo.Tmp_os_Booking SET (LOCK_ESCALATION = TABLE)\n\nALTER TABLE dbo.Tmp_os_Booking ADD CONSTRAINT\n\u0009DF_os_Booking_DiscountAmount DEFAULT ((0.0)) FOR DiscountAmount\n\nALTER TABLE dbo.Tmp_os_Booking ADD CONSTRAINT\n\u0009DF_os_Booking_DiscountCurrencyType DEFAULT (N'VND') FOR DiscountCurrencyType\n\nSET IDENTITY_INSERT dbo.Tmp_os_Booking ON\n\nIF EXISTS(SELECT * FROM dbo.os_Booking)\n\u0009 EXEC('INSERT INTO dbo.Tmp_os_Booking (Id, Deleted, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, ConfirmedBy, PartnerId, SaleId, StartDate, EndDate, Status, TripId, TripOption, Total, Paid, Email, Name, Note, AgencyId, PickupAddress, SpecialRequest, AgencyCode, IsApproved, CurrencyRate, IsPaid, PaidBase, IsPaymentNeeded, BookerId, CustomBookingId, AccountingStatus, LockedId, CruiseId, TransferTo, TransferAdult, TransferChildren, TransferBaby, Amended, TransferCost, IsTransferred, IsCharter, DropoffAddress, Invoice, CancelPay, CancelPayVND, Guide, Driver, GuideOnboard, Locker, Commission, CommissionVND, ComPaid, ComUSDPayed, ComVNDPayed, ComRate, GroupNo, DriverCollect, GuideCollect, DriverCollectVND, GuideCollectVND, DriverCollected, GuideCollected, PaidDate, ComPaidDate, TotalVND, IsVND, DriverCollectedUSD, GuideCollectedUSD, DriverCollectedVND, GuideCollectedVND, GuideConfirmed, AgencyConfirmed, IsDriverCollectVND, IsGuideCollectVND, IsCommissionVND, IsCancelPayVND, LockBy, LockDate, SeeoffTime, PickupTime, PUFlightDetails, PUCarRequirements, SOFlightDetails, SOCarRequirements, PUPickupAddress, PUDropoffAddress, SOPickupAddress, SODropoffAddress, LockStatus, DiscountAmount, DiscountPercent, DiscountCurrencyType)\n\u0009\u0009SELECT Id, Deleted, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate, ConfirmedBy, PartnerId, SaleId, StartDate, EndDate, Status, TripId, TripOption, Total, Paid, Email, Name, Note, AgencyId, PickupAddress, SpecialRequest, AgencyCode, IsApproved, CurrencyRate, IsPaid, PaidBase, IsPaymentNeeded, BookerId, CustomBookingId, AccountingStatus, LockedId, CruiseId, TransferTo, TransferAdult, TransferChildren, TransferBaby, Amended, TransferCost, IsTransferred, IsCharter, DropoffAddress, Invoice, CancelPay, CancelPayVND, Guide, Driver, GuideOnboard, Locker, Commission, CommissionVND, ComPaid, ComUSDPayed, ComVNDPayed, ComRate, GroupNo, DriverCollect, GuideCollect, DriverCollectVND, GuideCollectVND, DriverCollected, GuideCollected, PaidDate, ComPaidDate, TotalVND, IsVND, DriverCollectedUSD, GuideCollectedUSD, DriverCollectedVND, GuideCollectedVND, GuideConfirmed, AgencyConfirmed, IsDriverCollectVND, IsGuideCollectVND, IsCommissionVND, IsCancelPayVND, LockBy, LockDate, SeeoffTime, PickupTime, PUFlightDetails, PUCarRequirements, SOFlightDetails, SOCarRequirements, PUPickupAddress, PUDropoffAddress, SOPickupAddress, SODropoffAddress, LockStatus, DiscountAmount, DiscountPercent, DiscountCurrencyType FROM dbo.os_Booking WITH (HOLDLOCK TABLOCKX)')\n\nSET IDENTITY_INSERT dbo.Tmp_os_Booking OFF\n\nALTER TABLE dbo.os_BookingRoom\n\u0009DROP CONSTRAINT FK_os_BookingRoom_os_Booking\n\nALTER TABLE dbo.os_Customer\n\u0009DROP CONSTRAINT FK_os_Customer_os_Booking\n\nDROP TABLE dbo.os_Booking\n\nEXECUTE sp_rename N'dbo.Tmp_os_Booking', N'os_Booking', 'OBJECT' \n\nALTER TABLE dbo.os_Booking ADD CONSTRAINT\n\u0009PK__os_Booking__628FA481 PRIMARY KEY CLUSTERED \n\u0009(\n\u0009Id\n\u0009) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]\n\n\nCOMMIT\nselect Has_Perms_By_Name(N'dbo.os_Booking', 'Object', 'ALTER') as ALT_Per, Has_Perms_By_Name(N'dbo.os_Booking', 'Object', 'VIEW DEFINITION') as View_def_Per, Has_Perms_By_Name(N'dbo.os_Booking', 'Object', 'CONTROL') as Contr_Per BEGIN TRANSACTION\n\nALTER TABLE dbo.os_Customer ADD CONSTRAINT\n\u0009FK_os_Customer_os_Booking FOREIGN KEY\n\u0009(\n\u0009BookingId\n\u0009) REFERENCES dbo.os_Booking\n\u0009(\n\u0009Id\n\u0009) ON UPDATE  CASCADE \n\u0009 ON DELETE  SET NULL \n\u0009\n\nALTER TABLE dbo.os_Customer SET (LOCK_ESCALATION = TABLE)\n\nCOMMIT\nselect Has_Perms_By_Name(N'dbo.os_Customer', 'Object', 'ALTER') as ALT_Per, Has_Perms_By_Name(N'dbo.os_Customer', 'Object', 'VIEW DEFINITION') as View_def_Per, Has_Perms_By_Name(N'dbo.os_Customer', 'Object', 'CONTROL') as Contr_Per BEGIN TRANSACTION\n\nALTER TABLE dbo.os_BookingRoom ADD CONSTRAINT\n\u0009FK_os_BookingRoom_os_Booking FOREIGN KEY\n\u0009(\n\u0009BookId\n\u0009) REFERENCES dbo.os_Booking\n\u0009(\n\u0009Id\n\u0009) ON UPDATE  CASCADE \n\u0009 ON DELETE  SET NULL \n\u0009\n\nALTER TABLE dbo.os_BookingRoom SET (LOCK_ESCALATION = TABLE)\n\nCOMMIT\nselect Has_Perms_By_Name(N'dbo.os_BookingRoom', 'Object', 'ALTER') as ALT_Per, Has_Perms_By_Name(N'dbo.os_BookingRoom', 'Object', 'VIEW DEFINITION') as View_def_Per, Has_Perms_By_Name(N'dbo.os_BookingRoom', 'Object', 'CONTROL') as Contr_Per ")
                .ExecuteUpdate();%>
        </div>
    </form>
</body>
</html>
